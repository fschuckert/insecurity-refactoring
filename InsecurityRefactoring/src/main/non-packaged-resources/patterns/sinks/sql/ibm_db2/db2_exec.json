{"init":[],"code":["<call>(db2_exec,<any>(),%input)"],"pattern_type":"expression","generates":[{"init":["<=>(<$>(dsn),<s>(DATABASE=myDB;HOSTNAME=ibm_db2;PORT=50000;PROTOCOL=TCPIP;UID=db2inst1;PWD=ibm_db2_pw;))","<=>(<$>(db),<call>(db2_connect,<$>(dsn),<s>(),<s>()))"],"generate_output_code":["<=>(<$>(stmt),%input)","<if>(<==>(<$>(stmt),<false>()),<stmtlist>(<call>(die,<call>(db2_stmt_errormsg))))","<while>(<=>(<$>(row),<call>(db2_fetch_array,<$>(stmt))),<echo>(<call>(htmlentities,<call>(print_r,<$>(row),<true>()))))"],"define":["init_db2"],"params":["<$>(db)"]}],"generate_files":[{"|pre|init.sql":["CREATE DATABASE myDB;","USE myDB;"]},{"Dockerfile":["FROM php:7.3-apache","# To build the ibm_db2 extension, the DB2 application development header files and libraries must be installed on your system. ","# DB2 does not install these by default, so you may have to return to your DB2 installer and add this option. ","# The header files are included with the DB2 Application Development Client freely available for download from ","# the IBM DB2 Universal Database Â» support site: https:\/\/www.ibm.com\/developerworks\/downloads\/im\/db2express\/index.html","","# https:\/\/github.com\/php\/pecl-database-ibm_db2","# Download linuxx64_odbc_cli.tar.gz from https:\/\/public.dhe.ibm.com\/ibmdl\/export\/pub\/software\/data\/db2\/drivers\/odbc_cli\/","","## add header files and libraries","RUN mkdir -p \/opt\/ibm\/ && curl https:\/\/public.dhe.ibm.com\/ibmdl\/export\/pub\/software\/data\/db2\/drivers\/odbc_cli\/linuxx64_odbc_cli.tar.gz | tar -xz -C \/opt\/ibm\/","","","## set env vars needed for PECL install","ENV IBM_DB_HOME=\/opt\/ibm\/clidriver","ENV LD_LIBRARY_PATH=\/opt\/ibm\/clidriver\/lib","","## install ibm_db2 drivers","RUN pecl install ibm_db2","","RUN docker-php-ext-enable ibm_db2","","#RUN docker-php-ext-install pdo ibm_db2","RUN a2enmod rewrite","COPY src\/ \/var\/www\/html\/","EXPOSE 80"]},{"docker-compose.yml":["version: '2'","services:","  ibm_db2:","    build:","      context: .","      dockerfile: Dockerfile-ibm_db2","    privileged: true","    container_name: ibm_db2","    volumes:","      - .\/init.sql:\/data\/application\/init.sql","    restart: always","    environment:","      - LICENSE=accept","      - DB2INSTANCE=db2inst1","      - DB2INST1_PASSWORD=ibm_db2_pw","      - DBNAME=myDB","    ports:","      - \"50000:50000\"","  website:","    container_name: apache_php","    image: apache:php","    build:","      context: .\/","    volumes:","      - .\/src:\/var\/www\/html\/","    ports:","      - 8000:80","    depends_on:","      - ibm_db2"]},{"Dockerfile-ibm_db2":["FROM ibmcom\/db2:11.5.5.1","","RUN mkdir \/var\/custom","COPY createschema.sh \/var\/custom","RUN chmod a+x \/var\/custom\/createschema.sh"]},{"createschema.sh":["\/opt\/ibm\/db2\/V11.5\/bin\/db2 connect to myDB USER db2inst1 USING ibm_db2_pw;","\/opt\/ibm\/db2\/V11.5\/bin\/db2 -vtf \/data\/application\/init.sql"]}],"sufficient_escapes":["double"],"vuln":"sqli","name":"db2_exec","input_type":"expression","type":"sink","output_return":false}